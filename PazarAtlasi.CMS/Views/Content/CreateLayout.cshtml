@model PazarAtlasi.CMS.Models.ViewModels.CreateLayoutViewModel
@{
    ViewData["Title"] = "Create New Layout";
}

<div class="create-layout">
    <!-- Header -->
    <div class="flex flex-wrap items-center mb-8">
        <div class="w-full lg:w-2/3 mb-4 lg:mb-0">
            <div class="page-title-box">
                <div class="flex items-center mb-2">
                    <a href="@Url.Action("Layouts", "Content")" class="text-purple-600 hover:text-purple-800 mr-3">
                        <i class="fas fa-arrow-left"></i>
                    </a>
                    <h4
                        class="text-2xl font-bold text-slate-800 inline-block after:content-[''] after:absolute after:bottom-[-8px] after:left-0 after:w-10 after:h-[3px] after:bg-purple-800 after:rounded-full">
                        Create New Layout
                    </h4>
                </div>
                <p class="text-slate-500 mt-3 max-w-xl">
                    Create a new layout structure. You can add sections after creating the layout.
                </p>
            </div>
        </div>
    </div>

    <!-- Validation Summary -->
    @if (!ViewData.ModelState.IsValid)
    {
        <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <div class="flex">
                <i class="fas fa-exclamation-circle text-red-400 mr-2 mt-0.5"></i>
                <div>
                    <h3 class="text-sm font-medium text-red-800">Please correct the following errors:</h3>
                    <div class="mt-2 text-sm text-red-700">
                        <ul class="list-disc pl-5 space-y-1">
                            @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                            {
                                <li>@error.ErrorMessage</li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    }

    <!-- Success/Error Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
            <div class="flex">
                <i class="fas fa-check-circle text-green-400 mr-2 mt-0.5"></i>
                <p class="text-sm text-green-700">@TempData["SuccessMessage"]</p>
            </div>
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <div class="flex">
                <i class="fas fa-exclamation-circle text-red-400 mr-2 mt-0.5"></i>
                <p class="text-sm text-red-700">@TempData["ErrorMessage"]</p>
            </div>
        </div>
    }

    <form id="layoutForm" method="post" action="@Url.Action("SaveLayout", "Content")">
        @Html.AntiForgeryToken()
        <input type="hidden" name="Id" value="@Model.Id" />

        <div class="max-w-2xl mx-auto">
            <!-- Layout Settings Card -->
            <div class="bg-white rounded-xl shadow-md">
                <div class="p-6 border-b border-slate-100">
                    <h5 class="text-lg font-semibold text-slate-800 flex items-center">
                        <i class="fas fa-cog mr-2 text-purple-600"></i>
                        Layout Information
                    </h5>
                    <p class="text-sm text-slate-500 mt-1">Enter basic information for your new layout</p>
                </div>
                <div class="p-6 space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Layout Name *</label>
                        <input type="text" name="Name" value="@Model.Name" required
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-200 focus:border-purple-400"
                            placeholder="e.g., Main Layout, Blog Layout, Landing Page Layout" />
                        <span asp-validation-for="Name" class="text-red-500 text-xs mt-1"></span>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Description</label>
                        <textarea name="Description" rows="3"
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-200 focus:border-purple-400"
                            placeholder="Brief description of when and how this layout will be used">@Model.Description</textarea>
                        <p class="text-xs text-slate-500 mt-1">Optional: Describe the purpose of this layout</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-2">Status</label>
                            <select name="Status"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-200 focus:border-purple-400">
                                @foreach (var status in Enum.GetValues<PazarAtlasi.CMS.Domain.Common.Status>())
                                {
                                    @if (Model.Status == status)
                                    {
                                        <option value="@status" selected>@status.ToString()</option>
                                    }
                                    else
                                    {
                                        <option value="@status">@status.ToString()</option>
                                    }
                                }
                            </select>
                        </div>

                        <div class="flex items-center justify-center">
                            <div class="flex items-center">
                                <input type="checkbox" name="IsDefault" value="true" @(Model.IsDefault ? "checked" : "")
                                    class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-slate-300 rounded" />
                                <input type="hidden" name="IsDefault" value="false" />
                                <label class="ml-3 block text-sm text-slate-700">Set as default layout</label>
                            </div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex">
                            <i class="fas fa-info-circle text-blue-400 mr-2 mt-0.5"></i>
                            <div class="text-sm text-blue-700">
                                <p class="font-medium mb-1">What happens next?</p>
                                <p>After creating the layout, you'll be able to add sections like header, content areas, and footer to define the structure.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-8 flex items-center justify-between">
                <a href="@Url.Action("Layouts", "Content")" 
                   class="py-3 px-6 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm transition-colors inline-flex items-center">
                    <i class="fas fa-times mr-2"></i> Cancel
                </a>
                <div class="flex items-center space-x-3">
                    <button type="button" onclick="saveDraft()"
                        class="py-3 px-6 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm transition-colors inline-flex items-center">
                        <i class="fas fa-save mr-2"></i> Save as Draft
                    </button>
                    <button type="button" onclick="saveAndPublish()"
                        class="py-3 px-6 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm transition-colors inline-flex items-center">
                        <i class="fas fa-check mr-2"></i> Create Layout
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
    function saveDraft() {
        // Set status to Draft and submit
        document.querySelector('select[name="Status"]').value = '0'; // Draft
        document.getElementById('layoutForm').submit();
    }

    function saveAndPublish() {
        // Set status to Active and submit
        document.querySelector('select[name="Status"]').value = '1'; // Active
        document.getElementById('layoutForm').submit();
    }

    // Form validation
    document.getElementById('layoutForm').addEventListener('submit', function(e) {
        const nameInput = document.querySelector('input[name="Name"]');
        if (!nameInput.value.trim()) {
            e.preventDefault();
            nameInput.focus();
            alert('Please enter a layout name.');
            return false;
        }
    });
</script>
